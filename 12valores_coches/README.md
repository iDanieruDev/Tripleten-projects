# Descripción del proyecto
El servicio de venta de autos usados Rusty Bargain está desarrollando una aplicación para atraer nuevos clientes. Gracias a esa app, puedes averiguar rápidamente el valor de mercado de tu coche. Tenemos acceso al historial: especificaciones técnicas, versiones de equipamiento y precios. Debemos crear un modelo que determine el valor de mercado.

A Rusty Bargain le interesa:
- la calidad de la predicción;
- la velocidad de la predicción;
- el tiempo requerido para el entrenamiento

<h1>Tabla de contenidos<span class="tocSkip"></span></h1>
<div class="toc"><ul class="toc-item"><li><span><a href="#Inicialización" data-toc-modified-id="Inicialización-1"><span class="toc-item-num">1&nbsp;&nbsp;</span>Inicialización</a></span></li><li><span><a href="#Preparación-de-datos" data-toc-modified-id="Preparación-de-datos-2"><span class="toc-item-num">2&nbsp;&nbsp;</span>Preparación de datos</a></span><ul class="toc-item"><li><span><a href="#Carga-de-datos" data-toc-modified-id="Carga-de-datos-2.1"><span class="toc-item-num">2.1&nbsp;&nbsp;</span>Carga de datos</a></span></li><li><span><a href="#Analisis-de-tipo-de-datos" data-toc-modified-id="Analisis-de-tipo-de-datos-2.2"><span class="toc-item-num">2.2&nbsp;&nbsp;</span>Analisis de tipo de datos</a></span></li><li><span><a href="#Analisis-y-acondicionamiento-de-datos" data-toc-modified-id="Analisis-y-acondicionamiento-de-datos-2.3"><span class="toc-item-num">2.3&nbsp;&nbsp;</span>Analisis y acondicionamiento de datos</a></span><ul class="toc-item"><li><span><a href="#Columna-date_crawled" data-toc-modified-id="Columna-date_crawled-2.3.1"><span class="toc-item-num">2.3.1&nbsp;&nbsp;</span>Columna <code>date_crawled</code></a></span></li><li><span><a href="#Columna-price" data-toc-modified-id="Columna-price-2.3.2"><span class="toc-item-num">2.3.2&nbsp;&nbsp;</span>Columna <code>price</code></a></span></li><li><span><a href="#Columna-vehicle_type" data-toc-modified-id="Columna-vehicle_type-2.3.3"><span class="toc-item-num">2.3.3&nbsp;&nbsp;</span>Columna <code>vehicle_type</code></a></span></li><li><span><a href="#Columna-registration_year" data-toc-modified-id="Columna-registration_year-2.3.4"><span class="toc-item-num">2.3.4&nbsp;&nbsp;</span>Columna <code>registration_year</code></a></span></li><li><span><a href="#Columna-gearbox" data-toc-modified-id="Columna-gearbox-2.3.5"><span class="toc-item-num">2.3.5&nbsp;&nbsp;</span>Columna <code>gearbox</code></a></span></li><li><span><a href="#Columna-power" data-toc-modified-id="Columna-power-2.3.6"><span class="toc-item-num">2.3.6&nbsp;&nbsp;</span>Columna <code>power</code></a></span></li><li><span><a href="#Columna-model" data-toc-modified-id="Columna-model-2.3.7"><span class="toc-item-num">2.3.7&nbsp;&nbsp;</span>Columna <code>model</code></a></span></li><li><span><a href="#Columna-mileage" data-toc-modified-id="Columna-mileage-2.3.8"><span class="toc-item-num">2.3.8&nbsp;&nbsp;</span>Columna <code>mileage</code></a></span></li><li><span><a href="#Columna-registration_month" data-toc-modified-id="Columna-registration_month-2.3.9"><span class="toc-item-num">2.3.9&nbsp;&nbsp;</span>Columna <code>registration_month</code></a></span></li><li><span><a href="#Columna-fuel_type" data-toc-modified-id="Columna-fuel_type-2.3.10"><span class="toc-item-num">2.3.10&nbsp;&nbsp;</span>Columna <code>fuel_type</code></a></span></li><li><span><a href="#Columna-brand" data-toc-modified-id="Columna-brand-2.3.11"><span class="toc-item-num">2.3.11&nbsp;&nbsp;</span>Columna <code>brand</code></a></span></li><li><span><a href="#Columna-not_repaired" data-toc-modified-id="Columna-not_repaired-2.3.12"><span class="toc-item-num">2.3.12&nbsp;&nbsp;</span>Columna <code>not_repaired</code></a></span></li><li><span><a href="#Columna-date_created" data-toc-modified-id="Columna-date_created-2.3.13"><span class="toc-item-num">2.3.13&nbsp;&nbsp;</span>Columna <code>date_created</code></a></span></li><li><span><a href="#Columna-number_of_pictures" data-toc-modified-id="Columna-number_of_pictures-2.3.14"><span class="toc-item-num">2.3.14&nbsp;&nbsp;</span>Columna <code>number_of_pictures</code></a></span></li><li><span><a href="#Columna-postal_code" data-toc-modified-id="Columna-postal_code-2.3.15"><span class="toc-item-num">2.3.15&nbsp;&nbsp;</span>Columna <code>postal_code</code></a></span></li><li><span><a href="#Columna-last_seen" data-toc-modified-id="Columna-last_seen-2.3.16"><span class="toc-item-num">2.3.16&nbsp;&nbsp;</span>Columna <code>last_seen</code></a></span></li><li><span><a href="#Eliminamos-duplicados" data-toc-modified-id="Eliminamos-duplicados-2.3.17"><span class="toc-item-num">2.3.17&nbsp;&nbsp;</span>Eliminamos duplicados</a></span></li></ul></li><li><span><a href="#Preparacion-final-de-la-data-antes-del-entrenamiento" data-toc-modified-id="Preparacion-final-de-la-data-antes-del-entrenamiento-2.4"><span class="toc-item-num">2.4&nbsp;&nbsp;</span>Preparacion final de la data antes del entrenamiento</a></span></li></ul></li><li><span><a href="#Entrenamiento-de-modelos" data-toc-modified-id="Entrenamiento-de-modelos-3"><span class="toc-item-num">3&nbsp;&nbsp;</span>Entrenamiento de modelos</a></span><ul class="toc-item"><li><span><a href="#Entrenamiento-de-modelos-clásicos-de-regresión" data-toc-modified-id="Entrenamiento-de-modelos-clásicos-de-regresión-3.1"><span class="toc-item-num">3.1&nbsp;&nbsp;</span>Entrenamiento de modelos clásicos de regresión</a></span><ul class="toc-item"><li><span><a href="#Modelo-de-arbol-de-decisión" data-toc-modified-id="Modelo-de-arbol-de-decisión-3.1.1"><span class="toc-item-num">3.1.1&nbsp;&nbsp;</span>Modelo de arbol de decisión</a></span></li><li><span><a href="#Modelo-de-bosques-aleatorios" data-toc-modified-id="Modelo-de-bosques-aleatorios-3.1.2"><span class="toc-item-num">3.1.2&nbsp;&nbsp;</span>Modelo de bosques aleatorios</a></span></li><li><span><a href="#Modelo-de-regresión-lineal" data-toc-modified-id="Modelo-de-regresión-lineal-3.1.3"><span class="toc-item-num">3.1.3&nbsp;&nbsp;</span>Modelo de regresión lineal</a></span></li></ul></li><li><span><a href="#Entrenamiento-de-modelos-de-potenciación-del-gradiente" data-toc-modified-id="Entrenamiento-de-modelos-de-potenciación-del-gradiente-3.2"><span class="toc-item-num">3.2&nbsp;&nbsp;</span>Entrenamiento de modelos de potenciación del gradiente</a></span><ul class="toc-item"><li><span><a href="#Modelo-de-regresión-CatBoost-(CatBoostRegressor)" data-toc-modified-id="Modelo-de-regresión-CatBoost-(CatBoostRegressor)-3.2.1"><span class="toc-item-num">3.2.1&nbsp;&nbsp;</span>Modelo de regresión CatBoost (CatBoostRegressor)</a></span></li><li><span><a href="#Modelo-de-regresión-LightGBM-(LGBMRegressor)" data-toc-modified-id="Modelo-de-regresión-LightGBM-(LGBMRegressor)-3.2.2"><span class="toc-item-num">3.2.2&nbsp;&nbsp;</span>Modelo de regresión LightGBM (LGBMRegressor)</a></span></li><li><span><a href="#Modelo-de-regresión-XGBoost-(XGBRFRegressor)" data-toc-modified-id="Modelo-de-regresión-XGBoost-(XGBRFRegressor)-3.2.3"><span class="toc-item-num">3.2.3&nbsp;&nbsp;</span>Modelo de regresión XGBoost (XGBRFRegressor)</a></span></li></ul></li></ul></li><li><span><a href="#Análisis-y-comparación-de-los-modelos" data-toc-modified-id="Análisis-y-comparación-de-los-modelos-4"><span class="toc-item-num">4&nbsp;&nbsp;</span>Análisis y comparación de los modelos</a></span><ul class="toc-item"><li><span><a href="#Modelos-clásicos-de-regresión" data-toc-modified-id="Modelos-clásicos-de-regresión-4.1"><span class="toc-item-num">4.1&nbsp;&nbsp;</span>Modelos clásicos de regresión</a></span><ul class="toc-item"><li><span><a href="#Modelo-de-arbol-de-decisión" data-toc-modified-id="Modelo-de-arbol-de-decisión-4.1.1"><span class="toc-item-num">4.1.1&nbsp;&nbsp;</span>Modelo de arbol de decisión</a></span></li><li><span><a href="#Modelo-de-bosques-aleatorios" data-toc-modified-id="Modelo-de-bosques-aleatorios-4.1.2"><span class="toc-item-num">4.1.2&nbsp;&nbsp;</span>Modelo de bosques aleatorios</a></span></li><li><span><a href="#Modelo-de-regresión-lineal" data-toc-modified-id="Modelo-de-regresión-lineal-4.1.3"><span class="toc-item-num">4.1.3&nbsp;&nbsp;</span>Modelo de regresión lineal</a></span></li></ul></li><li><span><a href="#Modelos-de-potenciación-del-grandiente" data-toc-modified-id="Modelos-de-potenciación-del-grandiente-4.2"><span class="toc-item-num">4.2&nbsp;&nbsp;</span>Modelos de potenciación del grandiente</a></span><ul class="toc-item"><li><span><a href="#Modelo-CatBoost" data-toc-modified-id="Modelo-CatBoost-4.2.1"><span class="toc-item-num">4.2.1&nbsp;&nbsp;</span>Modelo CatBoost</a></span></li><li><span><a href="#Modelo-LightGBM" data-toc-modified-id="Modelo-LightGBM-4.2.2"><span class="toc-item-num">4.2.2&nbsp;&nbsp;</span>Modelo LightGBM</a></span></li><li><span><a href="#Modelo-XGBoost" data-toc-modified-id="Modelo-XGBoost-4.2.3"><span class="toc-item-num">4.2.3&nbsp;&nbsp;</span>Modelo XGBoost</a></span></li></ul></li><li><span><a href="#Comparación-final-de-todos-los-modelos" data-toc-modified-id="Comparación-final-de-todos-los-modelos-4.3"><span class="toc-item-num">4.3&nbsp;&nbsp;</span>Comparación final de todos los modelos</a></span></li></ul></li><li><span><a href="#Conclusión" data-toc-modified-id="Conclusión-5"><span class="toc-item-num">5&nbsp;&nbsp;</span>Conclusión</a></span></li></ul></div>

## Descripción de los datos

El dataset está almacenado en el archivo `car_data.csv`.

**Características**  
- `DateCrawled` — fecha en la que se descargó el perfil de la base de datos
- `VehicleType` — tipo de carrocería del vehículo
- `RegistrationYear` — año de matriculación del vehículo
- `Gearbox` — tipo de caja de cambios
- `Power` — potencia (CV)
- `Model` — modelo del vehículo
- `Mileage` — kilometraje (medido en km de acuerdo con las especificidades regionales del conjunto de datos)
- `RegistrationMonth` — mes de matriculación del vehículo
- `FuelType` — tipo de combustible
- `Brand` — marca del vehículo
- `NotRepaired` — vehículo con o sin reparación
- `DateCreated` — fecha de creación del perfil
- `NumberOfPictures` — número de fotos del vehículo
- `PostalCode` — código postal del propietario del perfil (usuario)
- `LastSeen` — fecha de la última vez que el usuario estuvo activo

**Objetivo** 
- `Price` — precio (en euros)

## Librerias usadas

- pandas
- matplotlib.pyplot
- numpy
- time
- sklearn
- catboost
- lightgbm
- xgboost

# Conclusión
En base a la tabla del punto anterior podemos ver que, en general, los modelos clásicos de regresión (Arbol de decisión, Bosque Aleatorio y regresión lineal) tiene un desempeño menor que los modelos CatBoost y LightGBM, en particular el modelo de regresión lineal. Por otro lado, los modelos de potenciación del gradiente CatBoost y LightGBM mostraron un desempeño superior e incluso en el caso de LightGBM, un tiempo de entrenamiento bastante bajo, mientras que XGBoost en general de todos los modelos fue el que mostro el peor desempeño y necesito un tiempo de entrenamiento elevado. Con respecto a los tiempo de predicción, los 6 modelos predicen bastante rápido y este valor tiende a ser despreciable si lo comparamos con los tiempos de entrenamiento.

En conclusión, el modelo que mas se ajusta a los requerimientos de la empresa es LightGBM con los hiperparametros ```boosting_type='gbdt', objective='regression', num_leaves=31,learning_rate= 0.5, n_estimators=200```, tanto por su alta precisión, como por el poco tiempo que requiere para ser entrenado.